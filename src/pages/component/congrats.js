import { getData } from "../../utils/db";
import React, { useEffect, useState } from "react";
import Modal from "react-bootstrap/Modal";
import { CopyToClipboard } from "react-copy-to-clipboard";
import Link from "next/link";
import Loader from "../../hooks/loader";
import CryptoJS from "crypto-js";

const Congrats = () => {
    const [show, setShow] = useState(false);
  const [pvtKey, setPvtKey] = useState(null);
  const [copy, setCopy] = useState(false);
  const [loader, setLoader] = useState(false);

  const handleClose = () => setShow(false);
  const handleShow = () => setShow(true);

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    let res = await getData("dumObj");
    const key = "dopTPL_";
    // const myPrivateKey = CryptoJS.AES.decrypt(res?.privateKey, key).toString(
    //   CryptoJS.enc.Utf8
    // );
    // setPvtKey(myPrivateKey);
    setPvtKey(res?.phrase);
  };

  const CallCopy = () => {
    setCopy(true);
    setTimeout(() => {
      setCopy(false);
    }, [3000]);
  };
  return (
    <>
      {loader && <Loader />}
      <section className="congrats">
        <div className="custom-container">
          <div className="congrats-card">
            <div className="congrats-img">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="28"
                height="28"
                viewBox="0 0 28 28"
                fill="none"
              >
                <g clip-path="url(#clip0_41_9329)">
                  <path
                    d="M5.82669 11.8105L3.08525 18.9739C3.7499 21.5851 5.23084 23.9279 7.32123 25.675L10.7619 24.4113C8.97597 22.846 7.59674 20.8865 6.73848 18.6952C5.88023 16.5038 5.56766 14.1438 5.82669 11.8105ZM2.15881 21.3959L0.0553846 26.8875C-0.00428601 27.0356 -0.018736 27.1974 0.0137914 27.3534C0.0463188 27.5094 0.124423 27.6527 0.238607 27.7661C0.352791 27.8794 0.498138 27.9578 0.656975 27.9917C0.815813 28.0257 0.9813 28.0137 1.13332 27.9573L5.57032 26.3283C4.1016 24.9291 2.94064 23.2506 2.15881 21.3959Z"
                    fill="white"
                  />
                  <path
                    d="M11.7087 11.1401L8.58272 8.07903C7.36385 10.7506 7.09349 13.7449 7.81475 16.5844C8.53601 19.424 10.2074 21.9453 12.5623 23.7465L15.8981 22.5198C14.421 21.0186 13.2844 19.229 12.5624 17.268C11.8405 15.307 11.5496 13.2188 11.7087 11.1401ZM13.346 12.7433C13.4125 14.4669 13.8261 16.1607 14.563 17.7273C15.3 19.2939 16.3457 20.7025 17.6403 21.8722L20.0874 20.9736C20.2182 20.9245 20.3343 20.8441 20.4251 20.7398C20.516 20.6355 20.5788 20.5106 20.6078 20.3765C20.6367 20.2423 20.6309 20.1032 20.5909 19.9718C20.551 19.8404 20.478 19.7209 20.3788 19.6242L13.346 12.7433ZM19.464 15.3194C19.6213 15.4732 19.8345 15.5596 20.0569 15.5596C20.2792 15.5596 20.4924 15.4732 20.6497 15.3194C23.8019 12.2327 26.8697 13.1884 26.8988 13.1969C27.0045 13.2361 27.1172 13.254 27.2301 13.2495C27.3431 13.245 27.4539 13.2181 27.556 13.1706C27.6581 13.1232 27.7493 13.056 27.8242 12.9731C27.8991 12.8902 27.9562 12.7934 27.9919 12.6884C28.0276 12.5834 28.0414 12.4724 28.0322 12.3621C28.0231 12.2518 27.9913 12.1444 27.9387 12.0464C27.8861 11.9484 27.8139 11.8619 27.7263 11.7919C27.6387 11.722 27.5376 11.67 27.429 11.6393C27.263 11.5851 23.3504 10.3613 19.464 14.1583C19.3859 14.2344 19.3239 14.3248 19.2816 14.4245C19.2392 14.5241 19.2175 14.6309 19.2175 14.7388C19.2175 14.8467 19.2392 14.9536 19.2816 15.0532C19.3239 15.1528 19.3859 15.2433 19.464 15.3194ZM14.1326 8.94057C18.0073 5.13497 16.7575 1.30369 16.7051 1.14108C16.6283 0.942646 16.4762 0.780972 16.2805 0.689915C16.0848 0.598857 15.8606 0.585476 15.6551 0.652575C15.4495 0.719674 15.2784 0.862047 15.1776 1.04989C15.0769 1.23772 15.0542 1.45646 15.1144 1.66029C15.1144 1.69167 16.0991 4.69564 12.9469 7.77949C12.8641 7.85462 12.7977 7.94533 12.7515 8.04619C12.7054 8.14705 12.6805 8.25599 12.6783 8.36649C12.6762 8.47699 12.6968 8.58677 12.739 8.68928C12.7812 8.79178 12.8441 8.88489 12.9239 8.96304C13.0037 9.04119 13.0988 9.10277 13.2035 9.14409C13.3082 9.18542 13.4203 9.20563 13.5332 9.20354C13.646 9.20144 13.7572 9.17707 13.8603 9.13188C13.9633 9.0867 14.0559 9.02163 14.1326 8.94057ZM15.9097 10.6808C15.7832 10.8376 15.7195 11.0343 15.7304 11.2339C15.7413 11.4335 15.8262 11.6224 15.9691 11.7651C16.112 11.9079 16.3031 11.9947 16.5067 12.0093C16.7103 12.024 16.9124 11.9655 17.0751 11.8447C17.5092 11.6336 18.8522 12.4153 19.598 11.6935C20.3438 10.9717 19.5514 9.68229 19.7466 9.23155C20.2069 9.04042 21.5237 9.80211 22.2608 9.08606C22.9979 8.37002 22.2142 7.07486 22.4094 6.62412C22.8726 6.43298 24.1865 7.19467 24.9236 6.47863C25.6606 5.76258 24.877 4.46742 25.0722 4.01668C25.5325 3.82554 26.8493 4.58724 27.5864 3.87119C28.3234 3.15514 27.5252 1.8229 27.7408 1.40068C27.8641 1.24138 27.9239 1.04352 27.9089 0.844164C27.8939 0.644805 27.8053 0.457624 27.6595 0.317682C27.5137 0.17774 27.3209 0.0946382 27.117 0.0839416C26.9132 0.073245 26.7123 0.135688 26.5521 0.259574C25.8908 0.907154 26.0219 1.82004 26.1443 2.47048C25.4771 2.34781 24.5448 2.22228 23.8864 2.86986C23.228 3.51744 23.3562 4.43033 23.4786 5.08077C22.8114 4.9581 21.8791 4.83257 21.2207 5.48015C20.5623 6.12773 20.6905 7.04062 20.8129 7.69106C20.1457 7.56839 19.2135 7.44286 18.555 8.09044C17.8966 8.73802 18.0248 9.65091 18.1472 10.3013C17.48 10.1787 16.5478 10.0532 15.8893 10.7007L15.9097 10.6808ZM20.6468 3.70858C20.7643 3.59372 20.8443 3.44733 20.8768 3.28792C20.9092 3.12852 20.8927 2.96326 20.8292 2.81306C20.7658 2.66287 20.6582 2.53448 20.5202 2.44415C20.3822 2.35382 20.2199 2.3056 20.0539 2.3056C19.8879 2.3056 19.7257 2.35382 19.5877 2.44415C19.4497 2.53448 19.3421 2.66287 19.2787 2.81306C19.2152 2.96326 19.1986 3.12852 19.2311 3.28792C19.2636 3.44733 19.3436 3.59372 19.4611 3.70858C19.6184 3.8624 19.8316 3.9488 20.0539 3.9488C20.2763 3.9488 20.4895 3.8624 20.6468 3.70858Z"
                    fill="white"
                  />
                  <path
                    d="M25.9782 9.7621C26.4416 9.7621 26.8172 9.39425 26.8172 8.9405C26.8172 8.48674 26.4416 8.1189 25.9782 8.1189C25.5148 8.1189 25.1392 8.48674 25.1392 8.9405C25.1392 9.39425 25.5148 9.7621 25.9782 9.7621Z"
                    fill="white"
                  />
                  <path
                    d="M24.2011 16.4804C24.0836 16.5952 24.0036 16.7416 23.9711 16.901C23.9386 17.0605 23.9552 17.2257 24.0187 17.3759C24.0821 17.5261 24.1897 17.6545 24.3277 17.7448C24.4657 17.8352 24.6279 17.8834 24.7939 17.8834C24.9599 17.8834 25.1222 17.8352 25.2602 17.7448C25.3982 17.6545 25.5058 17.5261 25.5692 17.3759C25.6327 17.2257 25.6492 17.0605 25.6168 16.901C25.5843 16.7416 25.5043 16.5952 25.3868 16.4804C25.2295 16.3266 25.0163 16.2402 24.7939 16.2402C24.5716 16.2402 24.3584 16.3266 24.2011 16.4804ZM12.3555 4.881C12.4729 4.76615 12.553 4.61976 12.5855 4.46035C12.6179 4.30094 12.6014 4.13568 12.5379 3.98549C12.4744 3.83529 12.3669 3.7069 12.2289 3.61657C12.0909 3.52624 11.9286 3.47803 11.7626 3.47803C11.5966 3.47803 11.4344 3.52624 11.2964 3.61657C11.1583 3.7069 11.0508 3.83529 10.9873 3.98549C10.9239 4.13568 10.9073 4.30094 10.9398 4.46035C10.9723 4.61976 11.0523 4.76615 11.1698 4.881C11.3271 5.03483 11.5403 5.12123 11.7626 5.12123C11.9849 5.12123 12.1982 5.03483 12.3555 4.881Z"
                    fill="white"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_41_9329">
                    <rect width="28" height="28" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <div className="upper-heading">
              <h6>Congratulations!</h6>
              <p>
              Your DOP wallet is now set up and ready to use. Remember, it is your responsibility to keep the wallet’s secret phrase in a secure location.
              </p>
            </div>
            <div className="bottom-content">
              <h6>Tips</h6>
              <ul>
                <li>Save backup copies of the phrase in multiple places.</li>
                <li>
                Do not share the wallet’s secret phrase with anyone.
                </li>
                <li>
                  {" "}
                  Beware of phishing schemes. DOP will never ask you to provide the secret phrase for your wallet.
                </li>
              </ul>
            </div>
            <div className="twice-btn">
              <Link
                // onClick={handleShow}
                onClick={()=>setLoader(true)} href="/unlockwallet"
                className="btn-verify done-btn w-100"
              >
                Done
              </Link>
            </div>
          </div>
        </div>
      </section>

      <Modal
        className="important-note"
        show={show}
        onHide={handleClose}
        centered
        backdrop="static"
      >
        <Modal.Body>
          <div className="inner-set">
            <div className="left">
              <h6>Important Note</h6>
              <p>Copy the secret phrase below and save it in a secure place.</p>
            </div>
          </div>
          <h6 className="address-text">
            <p className="copy_data posittion-relative click___One d-flex align-items-center ">
              <span className="gsvsvcvst">{pvtKey}</span>
            </p>
          </h6>
          <div className="twice-btn">
          <CopyToClipboard text={pvtKey} onCopy={() => CallCopy()}>
          <button className="w-100 copy-btn-new" >{copy ? "Copied" : "Copy"  }</button>
              </CopyToClipboard>
            <Link onClick={()=>setLoader(true)} href="/unlockwallet" className="w-100">
              <button className="btn-verify w-100">Done</button>
            </Link>
          </div>
        </Modal.Body>
      </Modal>
    </>
  );
};

export default Congrats;
